# 톡플갱어 (Talkpleganger) 기능 설명 보고서

> 내 말투를 학습하는 AI 카카오톡 비서

---

## 📋 목차

1. [프로젝트 개요](#프로젝트-개요)
2. [핵심 기능](#핵심-기능)
3. [신규 기능 (v2.0)](#신규-기능-v20)
4. [기술 스택](#기술-스택)
5. [API 엔드포인트](#api-엔드포인트)
6. [사용 시나리오](#사용-시나리오)

---

## 프로젝트 개요

**톡플갱어**는 사용자의 카카오톡 대화 스타일을 분석하여 개인화된 AI 응답을 생성하는 서비스입니다. 카카오톡 대화 내보내기 파일을 업로드하면 사용자의 말투, 이모지 사용 패턴, 특유의 표현 등을 학습하여 마치 본인이 직접 답장하는 것처럼 자연스러운 응답을 생성합니다.

### 주요 가치
- 🎭 **페르소나 기반**: 상황별 다중 페르소나 관리 (직장, 친구, 가족, 연인 등)
- 🤖 **AI 자동 응답**: GPT-4o 기반 자연스러운 답장 생성
- 😊 **감정 분석**: 상대방 감정에 맞춘 톤 자동 조절
- ⏰ **타이밍 추천**: 자연스러운 답장 시간 제안

---

## 핵심 기능

### 1. 페르소나 관리 (Persona)

카카오톡 대화 파일에서 사용자의 말투를 분석하여 페르소나를 생성합니다.

| 카테고리 | 아이콘 | 설명 | 예시 |
|---------|-------|------|------|
| work | 💼 | 회사/업무용 | 존댓말, 격식체 |
| friend | 👋 | 친구용 | 반말, 이모지 다수 |
| family | 🏠 | 가족용 | 친근한 존댓말 |
| partner | 💕 | 연인용 | 애교, 하트 이모지 |
| formal | 🎩 | 격식체/공식 | 완전한 경어체 |
| casual | 😎 | 일상/캐주얼 | 편한 말투 |

**분석 항목:**
- 말투 톤 (친근/격식/유머러스)
- 높임말 수준 (1~5단계)
- 이모지 사용 빈도
- 자주 쓰는 표현
- 대화 예시 패턴

---

### 2. Auto 모드 (자동 응답)

상대방 메시지를 입력하면 페르소나에 맞는 자동 응답을 생성합니다.

**기능:**
- 페르소나 기반 응답 생성
- 감정 분석 및 톤 자동 조절
- 대안 답장 3개 제시
- 신뢰도 점수 표시

**감정 분석 (10가지):**

| 감정 | 이모지 | 톤 조절 방식 |
|------|--------|-------------|
| happy | 😊 | 함께 기뻐하며 긍정적으로 |
| sad | 😢 | 공감하며 위로하는 톤 |
| angry | 😠 | 차분하고 이해하는 톤 |
| anxious | 😰 | 안심시키며 지지하는 톤 |
| excited | 🤩 | 열정적으로 함께 호응 |
| neutral | 😐 | 평소 말투 유지 |
| confused | 😕 | 명확하고 친절하게 설명 |
| grateful | 🙏 | 겸손하게 받아들이며 |
| apologetic | 😔 | 관대하게 안심시키며 |
| urgent | ⚡ | 간결하고 핵심만 |

---

### 3. Assist 모드 (멘트 추천)

특정 상황에 맞는 멘트를 추천받습니다.

**사용 예시:**
- "거절하고 싶은데 부드럽게 말하고 싶어"
- "축하 인사를 재치있게 하고 싶어"
- "사과하는 메시지 보내고 싶어"

---

### 4. Alibi 모드 (1:N 공지)

하나의 내용을 여러 그룹에 맞게 변환하여 전송합니다.

**기능:**
- 그룹별 맞춤 메시지 생성 (회사/친구/가족)
- DALL-E 3 기반 알리바이 증거 이미지 생성
- 일괄 공지 전환

---

## 신규 기능 (v2.0)

### 🧠 1. Context Memory (대화 맥락 기억)

Auto 모드에서 최근 대화 내용을 자동으로 불러와 더 자연스러운 응답을 생성합니다.

**특징:**
- 최근 대화 자동 로딩 (최대 20개)
- 대화 흐름을 고려한 응답 생성
- 맥락 윈도우 크기 조절 가능

**설정 옵션:**
```
auto_fetch_context: true/false  # 자동 맥락 로딩
context_window_size: 1~20       # 불러올 대화 수
```

**효과:**
- 이전 대화 주제 자연스럽게 이어가기
- 중복 질문/답변 방지
- 대화 흐름에 맞는 응답 생성

---

### ⏰ 2. Timing Recommendation (답장 타이밍 추천)

카카오톡 대화 패턴을 분석하여 자연스러운 답장 시간을 추천합니다.

**시간대 분류:**

| 시간대 | 시간 범위 | 설명 |
|--------|----------|------|
| early_morning | 06:00-09:00 | 이른 아침 |
| morning | 09:00-12:00 | 오전 |
| afternoon | 12:00-18:00 | 오후 |
| evening | 18:00-22:00 | 저녁 |
| night | 22:00-06:00 | 밤 |

**긴급도 레벨:**

| 레벨 | 권장 응답 시간 | 상황 |
|------|---------------|------|
| immediate | 즉시 | 긴급한 상황 |
| soon | 5-15분 | 중요한 대화 |
| normal | 15-60분 | 일반 대화 |
| relaxed | 1-3시간 | 여유로운 상황 |
| whenever | 편할 때 | 급하지 않은 내용 |

**분석 항목:**
- 평균 응답 시간
- 최소/최대 응답 시간
- 시간대별 응답 패턴
- 샘플 수 기반 신뢰도

---

### 💬 3. Follow-up Messages (읽씹 대응)

답장이 없을 때 자연스러운 후속 메시지를 생성합니다.

**전략 (경과 시간별):**

| 전략 | 경과 시간 | 설명 | 예시 |
|------|----------|------|------|
| gentle_reminder | 1-2시간 | 부드러운 리마인더 | "혹시 바빠?" |
| casual_check | 2-4시간 | 가벼운 안부 | "뭐해~?" |
| conversation_starter | 4-8시간 | 새 화제 전환 | "오늘 날씨 좋다!" |
| topic_change | 8-24시간 | 다른 주제 시작 | "어제 그 영화 봤어?" |
| reconnect | 24시간+ | 다시 연결 | "잘 지내지?" |

**관계 유형별 조절:**
- 친구: 가볍고 유머러스하게
- 연인: 애교 섞어서
- 직장: 업무적이고 간결하게
- 가족: 따뜻하고 걱정하는 톤

**UI 기능:**
- 시간 슬라이더로 경과 시간 설정
- 관계 유형 선택
- 3가지 대안 메시지 제시

---

### 🎨 4. Reaction Images (이미지 답장)

감정에 맞는 리액션 이미지를 DALL-E 3로 생성합니다.

**지원 감정 (10가지):**

| 감정 | 이모지 | 색상 | 사용 상황 |
|------|--------|------|----------|
| happy | 😊 | #22c55e | 기쁜 소식 들었을 때 |
| sad | 😢 | #3b82f6 | 위로할 때 |
| angry | 😠 | #ef4444 | 화났을 때 |
| surprised | 😲 | #f59e0b | 놀랐을 때 |
| love | 😍 | #ec4899 | 사랑 표현 |
| tired | 😴 | #6b7280 | 피곤할 때 |
| confused | 😕 | #8b5cf6 | 이해 안 될 때 |
| excited | 🤩 | #f97316 | 흥분될 때 |
| grateful | 🙏 | #14b8a6 | 감사할 때 |
| apologetic | 😔 | #6366f1 | 미안할 때 |

**이미지 스타일 (5가지):**

| 스타일 | 아이콘 | 설명 |
|--------|-------|------|
| cute_character | 🐱 | 귀여운 캐릭터 (카와이/치비) |
| emoji_art | 😀 | 큰 이모지 아트 |
| sticker | 🏷️ | 메신저 스티커 스타일 |
| meme | 🖼️ | 인터넷 밈 스타일 |
| minimal | ✏️ | 미니멀 라인 아트 |

**UI 기능:**
- 감정 그리드 선택
- 스타일 리스트 선택
- 맥락 입력 (선택)
- 이미지 다운로드/공유
- 최근 생성 기록 (10개)

---

## 기술 스택

### Backend
| 기술 | 버전 | 용도 |
|------|------|------|
| Python | 3.11+ | 백엔드 언어 |
| FastAPI | 0.100+ | API 프레임워크 |
| OpenAI API | - | GPT-4o, DALL-E 3 |
| Pydantic | v2 | 데이터 검증 |
| SQLite | - | 영구 저장소 |

### Frontend
| 기술 | 버전 | 용도 |
|------|------|------|
| React | 18+ | UI 프레임워크 |
| Vite | 7+ | 빌드 도구 |
| React Router | 7+ | 라우팅 |
| Axios | - | HTTP 클라이언트 |
| PWA | - | 프로그레시브 웹 앱 |

### 배포
| 플랫폼 | 용도 |
|--------|------|
| Cloudflare Pages | 프론트엔드 호스팅 |
| GitHub | 소스 코드 관리 |

---

## API 엔드포인트

### 페르소나 관리
| 메서드 | 엔드포인트 | 설명 |
|--------|-----------|------|
| POST | `/persona/` | 페르소나 생성 |
| GET | `/persona/` | 페르소나 목록 |
| GET | `/persona/{id}` | 페르소나 조회 |
| DELETE | `/persona/{id}` | 페르소나 삭제 |
| POST | `/persona/parse-kakao` | 카톡 파일 파싱 |
| POST | `/persona/create-from-kakao` | 카톡에서 페르소나 생성 |

### 응답 생성
| 메서드 | 엔드포인트 | 설명 |
|--------|-----------|------|
| POST | `/auto/respond` | 자동 응답 생성 (맥락+감정+타이밍) |
| POST | `/assist/suggest` | 멘트 추천 |
| POST | `/alibi/announce` | 그룹별 공지 생성 |
| POST | `/alibi/image` | 알리바이 이미지 생성 |

### 타이밍 (신규)
| 메서드 | 엔드포인트 | 설명 |
|--------|-----------|------|
| POST | `/timing/analyze` | 카톡 파일에서 타이밍 분석 |
| GET | `/timing/{id}/recommend` | 답장 타이밍 추천 |
| GET | `/timing/{id}/patterns` | 저장된 패턴 조회 |

### 읽씹 대응 (신규)
| 메서드 | 엔드포인트 | 설명 |
|--------|-----------|------|
| POST | `/followup/suggest` | 후속 메시지 생성 |
| GET | `/followup/strategies` | 전략 목록 |
| GET | `/followup/quick/{hours}` | 빠른 추천 |

### 리액션 이미지 (신규)
| 메서드 | 엔드포인트 | 설명 |
|--------|-----------|------|
| POST | `/reaction/generate` | 이미지 생성 |
| GET | `/reaction/emotions` | 감정 목록 |
| GET | `/reaction/styles` | 스타일 목록 |
| GET | `/reaction/quick` | 빠른 생성 |

### 히스토리
| 메서드 | 엔드포인트 | 설명 |
|--------|-----------|------|
| GET | `/history/{user_id}` | 대화 기록 조회 |
| GET | `/history/{user_id}/stats` | 대화 통계 |
| DELETE | `/history/{user_id}` | 대화 기록 삭제 |

---

## 사용 시나리오

### 시나리오 1: 바쁜 직장인의 카톡 관리

1. **페르소나 설정**: 회사 동료, 친구, 가족 각각의 대화 파일 업로드
2. **Auto 모드**: 받은 메시지에 대한 자동 응답 생성
3. **타이밍 추천**: 업무 중에는 "relaxed" 레벨로 응답 시간 조절
4. **읽씹 대응**: 바빠서 답 못했을 때 자연스러운 후속 메시지

### 시나리오 2: 연인과의 대화

1. **페르소나**: 연인용 애교 섞인 말투 학습
2. **리액션 이미지**: 감정 표현을 귀여운 이미지로
3. **Context Memory**: 이전 대화 맥락 기억하여 자연스러운 응답
4. **Follow-up**: 읽씹당했을 때 관계 유지 메시지

### 시나리오 3: 그룹 공지

1. **Alibi 모드**: "오늘 약속 못 가"를 그룹별로 변환
   - 회사: "오늘 개인 사정으로 회식 참석이 어려울 것 같습니다."
   - 친구: "야 오늘 갑자기 일 생겨서 ㅠㅠ 미안!"
   - 가족: "엄마 오늘 저녁 약속 못 갈 것 같아요~"

---

## 결론

톡플갱어 v2.0은 기존의 페르소나 기반 응답 생성에 더해 **대화 맥락 기억**, **타이밍 추천**, **읽씹 대응**, **리액션 이미지** 기능을 추가하여 더욱 자연스럽고 인간적인 AI 카톡 비서 경험을 제공합니다.

---

*Last Updated: 2026-02-17*
